# Exercise 2 - Flexible Programming Model: Using Fiori Elements Building Blocks on a Custom Page

The available [Fiori elements floorplans](https://help.sap.com/docs/SAP_FIORI_tools/17d50220bcd848aa854c9c182d65b699/2b2b12e708944d85a40d087194cc1edd.html)
for OData V4 cover most business scenarios that customers encounter with SAP. In fact, SAP uses these SAP Fiori elements floorplans to create roughly 80% of new SAP S/4HANA apps.\
If these floorplans do not meet your needs, the flexible programming model provided by SAP Fiori elements
allows to assemble your custom design by combining the available building blocks with SAPUI5 controls,
and leverage controller extensions in order to fine-tune the behaviour of your app.\
Please be aware that when using custom code in your SAP Fiori elements apps,
you will also have to make sure your extensions remain aligned with the evolving SAP Fiori design specification,
whereas the parts generated by annotations will automatically be updated if the standard changes.\
For our scenario, we want to mimic the behaviour of the list report and combine it with some SAPUI5 controls and add some app specific behaviours.
## Exercise 2.1 Guided Development: Adding Filter Bar Building Block

After completing these steps we will have added building blocks filter bar and table to your custom page.

(1) In Business Application Studio, on the Application Information tab Click **Open Page Map**.

![](./images/image1.png)

(2) Click **Configure Page**![](./images/image4.png).

![](./images/image3.png)

(3) Click the **Add** ![](./images/image6.png) menu item.

![](./images/image5.png)

(4) Click ![](./images/image8.png).

![](./images/image7.png)

(5) Click ![](./images/image10.png).

![](./images/image9.png)

(6) In Step 1 of the dialog, the selection fields to be shown in the filter bar are defined.\
Open drop-down **CDS File** and select annotation file ![](./images/image12.png) the annotations are to be inserted.

![](./images/image11.png)

(7) Open drop-down **Service** and select ![](./images/image14.png).

![](./images/image13.png)

(8) Open drop-down **Entity** and select ![](./images/image16.png).

![](./images/image15.png)

(9) Now let's add some selection fields. We start with ![](./images/image18.png).

![](./images/image17.png)

(10) Click **Add selection field** ![](./images/image20.png) twice.

![](./images/image19.png)

Enter selection fields **to_Customer_CustomerID** (11) and **TravelStatus_code** (12) as shown.

![](./images/image21.png)

(13) In the annotation preview pane, you can see the generated annotation.\
Clicking ![](./images/image25.png) inserts it into the target annotation file.

![](./images/image24.png)

(14)  File **annotations.cds** is opened, showing the inserted annotation.

![](./images/image26.png)

(15) Click ![](./images/image29.png) to get to step 2 in the development guide.

![](./images/image28.png)

(16) Open drop-down **Service** and select ![](./images/image31.png).

(17) Open drop-down **Entity** and select ![](./images/image32.png).

(18) Open drop-down **Selection Fields Qualifier** and select ![](./images/image33.png).

(19) Open drop-down **Aggregation Path** and select ![](./images/image34.png).\
The aggregation path points to the location in the xml view where the building block is to be inserted.

(20) Click ![](./images/image35.png).

![](./images/image30.png)

(21) Click ![](./images/image37.png).

![](./images/image36.png)

(22) the **Page Editor** shows the added **filter bar building block** for the **Custom Page**.

(23) In the opened file **Main.view.xml**, you can see the inserted **filter bar building block**.

![](./images/image38.png)

Please note, the property **metaPath** is referring to the **SelectionFields** annotation that has been inserted in the first step of the guide.

![](./images/image38a.png)

(24) If not already started, let's start the App Preview. Click the SAP Fiori icon ![](./images/image40.png) in the left toolbar of Business Application Studio.

(25) Click **Preview Application** ![](./images/image41.png).

![](./images/image39.png)

(26) This opens a drop-down on top. Select npm script ![](./images/image43.png).

![](./images/image42.png)

(27) A separate browser tab is opened, showing the filter bar on top. Open a value help to make sure that filter values are shown.

![](./images/image44.png)

The corresponding value list annotations are provided in the project and can be found in file **app/value-helps.cds** retrieved from the backend OData metadata.

## Exercise 2.2 Adding Table Building Block

We will now use another development guide to add a table building block to the custom page and semantically connect it to the filter bar.

(28) In the page editor for the custom page, click ![](./images/image47.png) menu item .
![](./images/image46.png)

(29) Click ![](./images/image49.png).

![](./images/image48.png)

(30) The development guide **Add a table building block** is opened. Click ![](./images/image51.png).

![](./images/image50.png)

Open drop-downs and select entries for **CDS File** (31), **Service** (32) and **Entity** (33) as shown below.

![](./images/image52.png)

(34) In section **Column Parameters**, open drop-down **Property** and select ![](./images/image57.png).

![](./images/image56.png)

(35) Click **Add column** 6 times .

![](./images/image58.png)

(36) Add the following properties as shown below:

- TravelStatus_code
- BeginDate
- EndDate
- to_Agency_AgencyID
- to_Customer_CustomerID
- TotalPrice

![](./images/image59.png)

(37) Click ![](./images/image62.png).

![](./images/image61.png)

(38) File **app/managetravels/annotations.cds** is opened, showing the inserted **UI.LineItem** annotation.

![](./images/image63.png)

(39) In the development guide, click ![](./images/image65.png).

![](./images/image64.png)

(40) Enter the values as shown in the marked fields below.
Keep the **Binding Context Path Type** set to relative. This makes sure that the **metaPath** to the **LineItem** annotation is relative to entity **Travel**.
The **Aggregation Path** defines where building block table is to be inserted in the target xml view. Defining the **Associated Filter Bar ID** ensures that the filter bar can interact with the table.
Leave all other values as proposed.

![](./images/image66.png)

(41) Scroll a bit down and open the drop-down for table property **Enable Read Only Mode**. Select ![](./images/image68.png).

(42) Click ![](./images/image69.png).

![](./images/image67.png)

(43) File **Main.view.xml** is opened, showing the inserted code snippet.

![](./images/image70.png)

(44) Click ![](./images/image72.png).

![](./images/image71.png)

(45) In the **Page Editor** we will now add some actions related to the table. Click ![](./images/image74.png).

![](./images/image73.png)

(46) Click ![](./images/image76.png).

![](./images/image75.png)

(47) Open the drop-down and select both available actions.

![](./images/image77.png)

(48) Click ![](./images/image80.png).

![](./images/image79.png)

(49) Enter **Accept Travel** in field **Label** for the action and click ![](./images/image82.png).

![](./images/image81.png)

(50) This will replace the entered string with a text key. Click ![](./images/image84.png).

![](./images/image83.png)

(51) Define a label for action **Reject Travel** and replace it with a text key in the same way.

![](./images/image85.png)

(52) Click ![](./images/image88.png).

(53) Open drop-down **Criticality** and select ![](./images/image89.png).\
The column values are then highlighted with semantic
colors and icons based on the criticality calculation logic defined for
the selected property in the back end.

(54) Click ![](./images/image90.png).

![](./images/image87.png)

## Exercise 2.3 Page Map: Add Object Page and Switch to Flexible Column Layout

In this exercise we will add an object page to check on the navigation capabilities of the table building block.\
We will then switch the page layout to flexible column layout. The flexible column layout allows users to see more\
details on the page, and to expand and collapse the screen areas.

(55) Click **Add New Page** ![](./images/image92.png).

![](./images/image91.png)

(56) On the **Add Page** dialog, open the drop-down of field **Navigation** and Select **Travel**. This defines the context binding of the object page and
automatically enables navigation for the custom page table.

![](./images/image93.png)

(57) Click ![](./images/image80.png).

![](./images/image95.png)

(58) Enable **Flexible Column Layout** by selecting the corresponding radio button.

(59) For **Select Layout for 2 Columns**, select **Mid-Expanded**.

(60) Below of it, set the **Flex Enabled** drop down to false as we don't require key user adaptation capabilities for the scenario. .

![](./images/image96.png)

As the object page is yet empty, we will define a title and description.

(61) Click **Configure Page**![](./images/image4.png).

![](./images/image99.png)

(62) Click ![](./images/image101.png).

(63) Enter **Travel** in field **Type Name** and create a translatable text key for it.

(64) Enter **Travels** in field **Type Name Plural** and create
another text key for it.

(65) Open drop-down field for **Title** and select property **Description**.

![](./images/image100.png)

(66) Open the drop-down for field **Description Type** and select **Property**.

![](./images/image103.png)

(67) In the **Define Property** dialog, open the drop-down for field **Description** and select ![](./images/image106.png).

![](./images/image105.png)

(68) Click ![](./images/image108.png).

![](./images/image107.png)

(69) Search for property **Editable Header Content** and set it to **false**.

![](./images/image109.png)

Switch back to the preview browser tab. It is now showing the filter bar and the table. Use the selection fields and trigger selection with **Go** to test the connection between both building blocks.\

(70) Click on a table line to navigate to the object page. By using table building block, navigation works solely through the context path without having to apply any additional custom coding.

![](./images/image111.png)

The pages are shown in the flexible column layout. You can use the **expand/collapse** buttons in to upper right corner to change the layout of the screen areas.\

The configured travel description and travel ID are shown in the object page header.

![](./images/image113.png)

## Summary

You've now successfully added building blocks filter bar and table to a custom view.

Continue to - [Exercise 3 - Improve Page Layout and add UI5 Freestyle Controls ](../ex3/README.md)
